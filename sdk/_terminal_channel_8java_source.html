<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Developer SDK: src/main/java/com/verifone/commerce/payment/TerminalChannel.java Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_doxygen.css" rel="stylesheet" type="text/css"/>
<link href="custom_navtree.css" rel="stylesheet" type="text/css"/>
<link href="custom_search.css" rel="stylesheet" type="text/css"/>
<link href="custom_tabs.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
    <img alt="Logo" width="100%" src="logo_v1.png"/>
    <div id="projectname">
      Developer SDK
    </div>
    <div id="projectbrief">Version 1.9.632.913d652c-152450467.</div>
  </div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_terminal_channel_8java_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TerminalChannel.java</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">package </span>com.verifone.commerce.payment;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">import</span> android.content.Context;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">import</span> android.content.ServiceConnection;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">import</span> android.os.ParcelFileDescriptor;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">import</span> android.os.RemoteException;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">import</span> android.support.annotation.NonNull;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">import</span> android.support.annotation.Nullable;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">import</span> java.io.FileOutputStream;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">import</span> java.io.InputStream;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">import</span> java.io.OutputStream;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">import</span> java.util.Map;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * Provides low-level access to the communication channels between the payment app and this app.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * This should be used with extreme caution, much of the functionality for the Commerce Platform</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * will NOT be able to function when using this class for communication.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html">   21</a></span>&#160;<span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html">TerminalChannel</a> <span class="keyword">extends</span> ProxyManager&lt;ITerminalChannel&gt; implements AutoCloseable, ITerminalChannel {<span class="comment"></span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">    /** Use this capability query to determine if a channel can be opened at all. */</span></div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a7d14852ad003ca3604ce9936645e0bc1">   23</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a7d14852ad003ca3604ce9936645e0bc1">OPEN_CHANNEL_CAPABILITY</a> = <span class="stringliteral">&quot;OPEN_CHANNEL_CAPABILITY&quot;</span>;<span class="comment"></span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">    /** The key to use when configuring the timeout duration when connecting. */</span></div><div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a2375ebedb592066259626dd52a7c54be">   25</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a2375ebedb592066259626dd52a7c54be">SO_CONNECT_TIMEOUT</a> = 1000;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    </div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="stringliteral">&quot;TerminalChannel&quot;</span>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">private</span> ITerminalChannel mProxy;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">     * Creates a representation of the proxy to communicate with the Transaction Service. Starts</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">     * the service binding and initialization process in the background. If called from a</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">     * background thread, blocks until the service binding and initialization is complete. If</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">     * called from the main thread, operations should not be performed immediately, instead</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">     * giving the service time to bind in the background. Attach a ServiceConnection object to</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">     * receive the proper notifications when the service is bound or if it disconnects</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">     * unexpectedly. This automatically attempts to recover in the cases where the service</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">     * disconnects unexpectedly, or if other errors occur that drop the connection, so do not</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">     * attempt to handle those error cases other than delaying messages until the service is</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">     * reconnected.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#aa05781f1a52e8970066a90037468932e">   42</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">static</span> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html">TerminalChannel</a> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#aa05781f1a52e8970066a90037468932e">getTerminalChannel</a>(<span class="keyword">final</span> Context context,</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                                   <span class="keyword">final</span> ServiceConnection altServiceConnection,</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                                   <span class="keyword">final</span> Map deviceParams) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_transaction_service_connector.html">TransactionServiceConnector</a>.<a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_transaction_service_connector.html#a120974aeb39510f2f75dcd1621b15249">attachServiceConnection</a>(altServiceConnection);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html">TerminalChannel</a>(context, deviceParams);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keyword">public</span> <span class="keyword">static</span> InputStream getInputStreamFromParceledDescriptor(ParcelFileDescriptor channel) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> FileInputStream(channel.getFileDescriptor());</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">public</span> <span class="keyword">static</span> OutputStream getOutputStreamFromParceledDescriptor(ParcelFileDescriptor channel) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> FileOutputStream(channel.getFileDescriptor());</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    </div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    @Override</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keyword">public</span> <span class="keywordtype">boolean</span> isCapable(@NonNull <span class="keyword">final</span> String capability) <span class="keywordflow">throws</span> RemoteException {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keyword">final</span> String methodContext = <span class="stringliteral">&quot;isCapable(&quot;</span> + capability + <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">if</span> (prepareForMethod(methodContext)) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                <span class="keywordflow">return</span> getProxy().isCapable(capability);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            } <span class="keywordflow">catch</span> (RemoteException e) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                errorOccurred(methodContext, e);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">     * Returns the current configuration that is used when connecting to the socket.</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    @Override</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a6b57106d093b0df2692c85825b08b07a">   75</a></span>&#160;    <span class="keyword">public</span> Map <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a6b57106d093b0df2692c85825b08b07a">getOptions</a>() throws RemoteException {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">final</span> String methodContext = <span class="stringliteral">&quot;getOptions&quot;</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">if</span> (prepareForMethod(methodContext)) {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="keywordflow">return</span> getProxy().getOptions();</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            } <span class="keywordflow">catch</span> (RemoteException e) {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                errorOccurred(methodContext, e);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">     * Tells whether or not the connection to the payment app is connected and ready.</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    @Override</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#afbf4768f0408a85337dbb9f1413d611a">   92</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#afbf4768f0408a85337dbb9f1413d611a">isConnected</a>() throws RemoteException {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keyword">final</span> String methodContext = <span class="stringliteral">&quot;isConnected&quot;</span>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">if</span> (prepareForMethod(methodContext)) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <span class="keywordflow">return</span> getProxy().isConnected();</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            } <span class="keywordflow">catch</span> (RemoteException e) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                errorOccurred(methodContext, e);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">     * Starts the connection to the device.</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">     * @param params</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">     * @throws android.os.RemoteException Translates any IOExceptions or similar exceptions to this</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">     * RemoteException for debugging purposes.</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    @Override</div><div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a52387df00f8cb26f187b41921c7a0b47">  112</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a52387df00f8cb26f187b41921c7a0b47">connect</a>(Map params) <span class="keywordflow">throws</span> RemoteException {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">final</span> String methodContext = <span class="stringliteral">&quot;connect&quot;</span>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">if</span> (prepareForMethod(methodContext)) {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                getProxy().connect(params);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            } <span class="keywordflow">catch</span> (RemoteException e) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                errorOccurred(methodContext, e);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">     * Connects to a bi-directional channel to allow more control over the flow of data. This should</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">     * not be used with the read/write methods.</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">     * @return The ParcelFileDescriptor that can then be converted into input/output streams as needed.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    @Nullable</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    @Override</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a9f2903d4f626671c4630aceef6b68de0">  131</a></span>&#160;    <span class="keyword">public</span> ParcelFileDescriptor <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a9f2903d4f626671c4630aceef6b68de0">getStream</a>() throws RemoteException {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keyword">final</span> String methodContext = <span class="stringliteral">&quot;getStream&quot;</span>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">if</span> (prepareForMethod(methodContext)) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keywordflow">return</span> getProxy().getStream();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            } <span class="keywordflow">catch</span> (RemoteException e) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                errorOccurred(methodContext, e);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">     * Reads some number of bytes from the input stream and stores them into the buffer array b.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">     * @param b byte: the buffer into which the data is read.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">     * @return int The total number of bytes read into the buffer, or -1 if there is no more data because the end of the stream has been reached.</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">     * @throws android.os.RemoteException Translates any IOExceptions or similar exceptions to this</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">     * RemoteException for debugging purposes.</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    @Override</div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a253f70627826bee411162c8f1f60c684">  152</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a253f70627826bee411162c8f1f60c684">read</a>(@NonNull byte[] b, <span class="keywordtype">int</span> offset, <span class="keywordtype">int</span> length) <span class="keywordflow">throws</span> RemoteException {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keyword">final</span> String methodContext = <span class="stringliteral">&quot;read&quot;</span>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> (prepareForMethod(methodContext)) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keywordflow">return</span> getProxy().read(b, offset, length);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            } <span class="keywordflow">catch</span> (RemoteException e) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                errorOccurred(methodContext, e);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">     * @param b byte: the data.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">     * @param offset int: the start offset in the data.</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">     * @param length int: the number of bytes to write.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">     * @throws android.os.RemoteException Translates any IOExceptions or similar exceptions to this</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">     * RemoteException for debugging purposes.</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    @Override</div><div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#af63aae6aec0968904c61efbf21aec190">  174</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#af63aae6aec0968904c61efbf21aec190">write</a>(@NonNull byte[] b, <span class="keywordtype">int</span> offset, <span class="keywordtype">int</span> length) <span class="keywordflow">throws</span> RemoteException {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keyword">final</span> String methodContext = <span class="stringliteral">&quot;write&quot;</span>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (prepareForMethod(methodContext)) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                getProxy().write(b, offset, length);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            } <span class="keywordflow">catch</span> (RemoteException e) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                errorOccurred(methodContext, e);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment"></span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">    /**</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">     * Closes the connection to the device, performing any relevant cleanup.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">     * @throws android.os.RemoteException Throws a remote exception with the appropriate information.</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    @Override</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a5ae591df94fc66ccb85cbb6565368bca">  191</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a5ae591df94fc66ccb85cbb6565368bca">close</a>() throws RemoteException {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keyword">final</span> String methodContext = <span class="stringliteral">&quot;close&quot;</span>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span> (prepareForMethod(methodContext)) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">try</span> {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                getProxy().close();</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            } <span class="keywordflow">catch</span> (RemoteException e) {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                errorOccurred(methodContext, e);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="keywordflow">throw</span> e;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    </div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    @Override</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">void</span> establishBinderLink(Map deviceParams) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        ITerminalChannel terminalChannelBinder =</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;              <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_transaction_service_connector.html">TransactionServiceConnector</a>.getTerminalChannelBinder(getContext(), deviceParams);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_transaction_service_connector.html">TransactionServiceConnector</a>.isConnectionValid(terminalChannelBinder)) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            setProxy(terminalChannelBinder);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    </div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    @Nullable</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    @Override</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    ITerminalChannel getExistingProxyInstance() {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">return</span> mProxy;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    @Override</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">void</span> setProxy(ITerminalChannel proxy) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        mProxy = proxy;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">private</span> <a class="code" href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html">TerminalChannel</a>(Context context, Map deviceParams) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        super(TAG, context, deviceParams);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div><div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_af63aae6aec0968904c61efbf21aec190"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#af63aae6aec0968904c61efbf21aec190">com.verifone.commerce.payment.TerminalChannel.write</a></div><div class="ttdeci">void write(@NonNull byte[] b, int offset, int length)</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00174">TerminalChannel.java:174</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_transaction_service_connector_html"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_transaction_service_connector.html">com.verifone.commerce.payment.TransactionServiceConnector</a></div><div class="ttdef"><b>Definition:</b> <a href="_transaction_service_connector_8java_source.html#l00030">TransactionServiceConnector.java:30</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_a52387df00f8cb26f187b41921c7a0b47"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a52387df00f8cb26f187b41921c7a0b47">com.verifone.commerce.payment.TerminalChannel.connect</a></div><div class="ttdeci">void connect(Map params)</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00112">TerminalChannel.java:112</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_a7d14852ad003ca3604ce9936645e0bc1"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a7d14852ad003ca3604ce9936645e0bc1">com.verifone.commerce.payment.TerminalChannel.OPEN_CHANNEL_CAPABILITY</a></div><div class="ttdeci">static final String OPEN_CHANNEL_CAPABILITY</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00023">TerminalChannel.java:23</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_a253f70627826bee411162c8f1f60c684"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a253f70627826bee411162c8f1f60c684">com.verifone.commerce.payment.TerminalChannel.read</a></div><div class="ttdeci">int read(@NonNull byte[] b, int offset, int length)</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00152">TerminalChannel.java:152</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_a6b57106d093b0df2692c85825b08b07a"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a6b57106d093b0df2692c85825b08b07a">com.verifone.commerce.payment.TerminalChannel.getOptions</a></div><div class="ttdeci">Map getOptions()</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00075">TerminalChannel.java:75</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_a5ae591df94fc66ccb85cbb6565368bca"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a5ae591df94fc66ccb85cbb6565368bca">com.verifone.commerce.payment.TerminalChannel.close</a></div><div class="ttdeci">void close()</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00191">TerminalChannel.java:191</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_a2375ebedb592066259626dd52a7c54be"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a2375ebedb592066259626dd52a7c54be">com.verifone.commerce.payment.TerminalChannel.SO_CONNECT_TIMEOUT</a></div><div class="ttdeci">static final int SO_CONNECT_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00025">TerminalChannel.java:25</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html">com.verifone.commerce.payment.TerminalChannel</a></div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00021">TerminalChannel.java:21</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_a9f2903d4f626671c4630aceef6b68de0"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#a9f2903d4f626671c4630aceef6b68de0">com.verifone.commerce.payment.TerminalChannel.getStream</a></div><div class="ttdeci">ParcelFileDescriptor getStream()</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00131">TerminalChannel.java:131</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_aa05781f1a52e8970066a90037468932e"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#aa05781f1a52e8970066a90037468932e">com.verifone.commerce.payment.TerminalChannel.getTerminalChannel</a></div><div class="ttdeci">static TerminalChannel getTerminalChannel(final Context context, final ServiceConnection altServiceConnection, final Map deviceParams)</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00042">TerminalChannel.java:42</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel_html_afbf4768f0408a85337dbb9f1413d611a"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_terminal_channel.html#afbf4768f0408a85337dbb9f1413d611a">com.verifone.commerce.payment.TerminalChannel.isConnected</a></div><div class="ttdeci">boolean isConnected()</div><div class="ttdef"><b>Definition:</b> <a href="_terminal_channel_8java_source.html#l00092">TerminalChannel.java:92</a></div></div>
<div class="ttc" id="classcom_1_1verifone_1_1commerce_1_1payment_1_1_transaction_service_connector_html_a120974aeb39510f2f75dcd1621b15249"><div class="ttname"><a href="classcom_1_1verifone_1_1commerce_1_1payment_1_1_transaction_service_connector.html#a120974aeb39510f2f75dcd1621b15249">com.verifone.commerce.payment.TransactionServiceConnector.attachServiceConnection</a></div><div class="ttdeci">static void attachServiceConnection(ServiceConnection altServiceConnection)</div><div class="ttdef"><b>Definition:</b> <a href="_transaction_service_connector_8java_source.html#l00245">TransactionServiceConnector.java:245</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- id is needed for treeview function! -->
<!-- <div id="nav-path" class="navpath">
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5eb159725f84c66aafd839904a4acdd0.html">main</a></li><li class="navelem"><a class="el" href="dir_fd3f6763802dee1ad875f6c80eac0bda.html">java</a></li><li class="navelem"><a class="el" href="dir_d8517d8b842053dc3dd7dde525dd9163.html">com</a></li><li class="navelem"><a class="el" href="dir_9b6b50013e7e392aba59aadc54aeeafb.html">verifone</a></li><li class="navelem"><a class="el" href="dir_5d234abe0e652e900ca888f9b6a6f98e.html">commerce</a></li><li class="navelem"><a class="el" href="dir_ef3061e2d989be06e3b2367709aeb27a.html">payment</a></li><li class="navelem"><b>TerminalChannel.java</b></li>
  </ul>
</div> -->
<div style="width: 100%;
	line-height: 140%;
	font: 400 14px/22px Roboto,sans-serif;
	color: black;">
<!--<div style="font-size: 11px;
	background-image: url('tab_b.png');
	background-repeat: repeat-x;
	background-position: 0 -5px;
	height: 30px;
	line-height: 30px;
	color: #8AA0CC;
	border: solid 1px #C2CDE4;
	overflow: hidden;
	margin: 0px;
	padding: 0px;"></div> -->
<p style="font-size: 11px;
	line-height: 100%;
	color: #ffffff;
	border: solid 1px #C2CDE4;
	margin: 10px;
	padding: 10px;">
This document is the confidential property of Verifone, Inc. Any reproduction or distribution of this document, in whole or in part, or the disclosure of any of the information contained herein, without the prior written consent of Verifone, Inc. is prohibited. This document and any supplemental material supplied as part of any review must be returned to Verifone, Inc. upon request. Notice: This document may go through material revisions over time. While the Company will make every effort to keep readers updated as changes occur, care must be taken by the reader to make sure they are reading the latest version.  Version numbers appear in the title page and revision history page of this document. All rights reserved. Verifone, the Verifone logo are either trademarks or registered trademarks of Verifone in the United States and/or other countries. All other trademarks or brand names are properties of their respective holders.</p>
</div>
</body>
</html>
